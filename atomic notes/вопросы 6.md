Tags: [[для собеседований]]

#golang 



## Интерфейсы



Все вопросы сводятся к следующему списку:

![[Screenshot From 2025-10-04 17-47-40.png]]



> [!info] 
> Интрерфейсы нужны для **уменьшения связанности кода** - лаконичное определение, если спросят



В рантайме интерфейс выглядит так

```go
type iface struct {
	tab *itab
	data unsafe.Pointer
}
```



> [!caution] 
> В Go есть правило "method set" из спецификации.
> 
> Кратко:
> 
> - Набор методов типа `T` содержит только методы с получателем `T`.
> 
> - Набор методов типа `*T` содержит методы с получателем `T` и `*T`.  
>   
>  Т.е. **ссылочный тип будет удовлетворять такому же интерфейсу, как и тип, на который он ссылается**
> 




1. `Nil` vs `not-nil` интерфейс

	В рантайме GO интерфейс - это **структура с двумя полями ссылочного типом**
	
	Каждая ссылка в 64-битной системе весит 8байт
	
	Соответственно пустой интерфейс будет весить 16 байт (32 в 32-битной системе)
	
	
	Переменная типа `interface` будет равно `nil` только тогда, когда **обе ссылки равны `nil`**, т.е. нет не только **данных**, но и **информации о типе данных**
	
	
	Пример с известным типом
	
	```go
	func foo(a interface{}) {  
	    println(a == nil)  // false!
	}  
	  
	func main() {  
	    var a int  
	  
	    foo(a)  
	}
	```
	
	
	
	Если ф-ия возвращает тип `interface{}`, даже без значений, то переменная будет проходить проверку на `nil`
	
	Однако при выводе через `fmt.Println` возьмется **динамическое значение**
	
	```go
	type SomeStruct struct{}  
	  
	func foo() interface{} {  
	  
	    var result *SomeStruct  
	  
	    return result  
	}  
	  
	func main() {  
	    res := foo()  
	  
	    if res != nil {  
	       fmt.Println("res != nil! res =", res)  
	    }  
	}
	```


---


2. Задача на error

	```go
	type SomeError struct{}  
	  
	func (s SomeError) Error() string {  
	    return "some error"  
	}  
	  
	func foo() error {  
	  
	    var result *SomeError  
	  
	    return result  
	}  
	  
	func main() {  
	    result := foo()  
	  
	    if result != nil {  
	       fmt.Println("Error occured!!!", result)  
	       return  
	    }  
	}
	// Error occured!!! <nil>
	```
	
	
	




---


## Related


