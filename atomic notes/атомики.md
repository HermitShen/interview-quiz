Tags: [[для собеседований]]

#golang 



## Атомики



1. Барьеры памяти (пререквизит к атомикам)

	Ключевой механизм работы атомиков - исопльзование **барьеров памяти**
	
	
	Компилятор в рамках оптимизации может переупорядочить **порядок инструкций** программы, если **выполнение станет быстрее**
	
	![[Screenshot From 2025-10-10 03-40-08.png]]
	
	
	Этим в том числе может заниматься и CPU
	
	![[Screenshot From 2025-10-10 03-41-26.png]]
	
	Причин для этого может быть много:
	
	- Разное **время выполнение команд** процессором (деление, например, занимает в разы больше времени, чем инкремент)
	  
	- Длительные **походы в память** (вместо долгих походов делаем операции с короткими прыжками)
	
	- Инвалидация кэшей (пока идет загрузка свежих данных из памяти сделаем другую операцию)
	
	
	
	Чтобы **запретить переупорядочевание** и существуют барьеры
	
	Они могут быть только на запись/чтение из памяти или смешанные 
	
	![[Screenshot From 2025-10-10 03-50-16.png]]
	


---


## Related


