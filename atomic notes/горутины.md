Tags: [[для собеседований]]

#golang 



## Горутины



1. Что такое горутина?

	Горутина - это **легковесный поток**
	
	
	Он легковесный по нескольким причинам:
	
	- Переключением контекста занимается не ядро ОС, а пользовательское приложение. **Syscall** (поход в **Kernel Space**) делать не нужно
	  
		Вместо двух CS (поток -> ядро -> поток), приложение переключается сразу на другую горутину (один CS)
		
		Это возможно благодаря тому, что каждая горутина хранит регистры и стек
		
		![[Screenshot From 2025-10-07 20-38-57.png]]
	 
	
	- **Начальный (минимальный) размер горутины** - всего лишь **2Кб**
	  
		Стек **может расти** условно бесконечно - **до 1 Гб** на 64-битной системе - это очень много  
		
		Для сравнения - поток ОС имеет фикс. размер 1-8 Мб
		
		Из этого следует, что мы можем насоздавать **намного больше горутин чем потоков ОС**
	  
	  
	- Горутины переключаются в  **строго определенные моменты**, но не во время **CPU-intensive** задач
	  
		Горутины согласуют работу между собой по приницпу **кооперативной 
		многозадачности
		
		Они сами сигнализируют о том, когда их можно **вытеснить**
		
		Причем вытеснение происходит **во время несложных задач**, например вызова ф-ии, поэтому е нужно сохранять все состояние процессора (регистры, кэш и т.д.)


> [!hint] 
> Минусы syscall:
> 
> ![[Screenshot From 2025-10-07 21-06-49.png]] 


---


2. Что такое горутина (2-й вариант)

	Если есть желание увести вопрос в сторону работы планировщика GO, можно ответить так:
	
	![[Screenshot From 2025-10-07 21-11-20.png]]
	
	
	Горутины управляются **рантаймом** (а точнее его частью - Планировщиком)
	
	Горутина вытесняется на основе ее состояние - за это отвечает часть планировщика под названием **Sysmon**
	
	
	![[Screenshot From 2025-10-07 21-23-44.png]]


---


## Related


