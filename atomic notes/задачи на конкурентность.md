Tags: [[для собеседований]]

#golang 



# Задачи


&emsp;

## Вопрос на понимание планировщика

&emsp;

Что будет выведено?

![[Screenshot From 2025-10-14 01-16-41.png]]

&emsp;

Тут важно понимать, что у горутин есть несколько состояний

Локальную очередь могут занимать **только горутины в состоянии "ready"**

&emsp;

По любой из **причин остановки** `waitReason` горутина **снимается с очереди** и переходит в состояние "waiting"

`time.Sleep` - одна из таких причин, поэтому горутины **не будут занимать очередь** все время, переданное в метод

В реальности все они будут "парковаться" одна за другой в порядке этой самой очереди

Если лог. процессоров больше - общее время парковки сократится

&emsp;

Как только время истечет, все горутины вернутся планировщиком в очередь или очереди (в зависимости от `GOMAXPROCS`) и выполнят `wg.Done`

Поэтому итоговое время займет **от 1мс**, но **гораздо меньше** чем если бы каждая горутина занимала очередь (в нашем примере это **10с**)

&emsp;
## Вопрос на замыкание

&emsp;

![[Screenshot From 2025-10-14 01-42-27.png]]

&emsp;

Если компания использует **легаси код**, то могут спросить про замыкания

После версии **1.22** такой код отработает корректно, потому что на каждой итерации для каждой `i` будут аллоцироваться разные участки  памяти

Т.е. у каждой горутины будет своя копия `i`

&emsp;

ДО этой версии значение бралось из одного участка памяти, с каждой итерацией он просто перезаписывался

Поэтому раньше все они бы вывели максимальное значение `i` или недалеко от него, т.к. горутины создаются не сразу и до этого момента `i` могла поменяться

И пришлось бы прокидывать копию переменной `i` в ф-ию

![[Screenshot From 2025-10-14 01-48-47.png]]







